{"code":"!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=1)}([function(t,e,n){const o=n(!function(){var t=new Error(\"Cannot find module './src/client/renderer/image_list'\");throw t.code=\"MODULE_NOT_FOUND\",t}());t.exports={getImageContainer:function(){if(this.instance)return this.instance;this.image_map=new Map,this.loaded_image_counter=0,this.outdated_sprites=[],this.loadImages()},loadImages:function(){for(let t of o){let e=new Image;e.onload=(()=>{this.imageLoaded()}),e.src=\"./img/\"+t.src,t.img=e,this.image_map.set(t.title,t)}images_info=[]},imageLoaded:function(){this.loaded_image_counter++==images_info.length&&this.updateSprites()},updateSprites:function(){for(let t of this.outdated_sprites)t.imageFinished()},get:function(t){return this.image_map.get(t)},pushOutDated:function(t){this.outdated_sprites.push(t)}}},function(t,e,n){\"use strict\";const o=n(!function(){var t=new Error(\"Cannot find module '~/src/shared/game_core'\");throw t.code=\"MODULE_NOT_FOUND\",t}()),i=n(!function(){var t=new Error(\"Cannot find module '~/src/client/renderer/sprite'\");throw t.code=\"MODULE_NOT_FOUND\",t}()),a=n(!function(){var t=new Error(\"Cannot find module '~/src/shared/player'\");throw t.code=\"MODULE_NOT_FOUND\",t}());n(0).getImageContainer();var r=60,c=0,s=0,l=new a;l.sprite=new i(\"Alien\",l.dimensions,2);var d,u=[],f=-1,m=0,p=0,g=[],h=100,v=0,y=!1,_=io.connect();function w(t,e){let n=d.state.locations[t],o=g[0].state.locations[t],i=g[0].timestamp-d.timestamp;0!==i&&(u[t].location.x+=(o.x-n.x)/i*(e-h-d.timestamp),u[t].location.y+=(o.y-n.y)/i*(e-h-d.timestamp))}function x(t){if(u.length!==t.locations.length)for(var e in u=[],t.locations){u.push({location:t.locations[e],dimensions:o.getDimensionsObj(100,50)});var n=new i(\"Person\",u[e].dimensions,.5);u[e].sprite=n}else for(var e in u)u[e].location=t.locations[e];f=t.self_index}function O(t,e){ctx.fillStyle=e,ctx.fillRect(t.location.x,t.location.y,t.dimensions.w,t.dimensions.l)}_.on(\"connect\",function(t){document.addEventListener(\"keydown\",E),document.addEventListener(\"keyup\",M),m=Date.now(),setInterval(function(){p=Date.now()-m,m=Date.now(),function(){var t=l.move(p);o.anyIntersect(l,u,f)&&(l.location=t);var e=o.checkBoundry(l.location,l.dimensions);l.location=e.loc,l.setOrientation(c,s)}(),function(){if(void 0===d||void 0===g)return;if(x(d.state),0===g.length)return;let t=Date.now();for(var e in u){if(e>=g[0].state.locations.length)break;if(e!=f)w(e,t);else{var n=g[g.length-1].state.self_index;u[e].location=g[g.length-1].state.locations[n]}}for(;g.length>0&&t-g[0].timestamp>=h;)d=g.shift()}(),_.emit(\"move\",{loc:l.location,cc:v}),function(){for(var t in ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height),O(l,\"blue\"),l.sprite.drawDirectional(l.location.x,l.location.y,l.orientation),u)(t!=f||y&&t<u.length)&&(O(u[t],\"red\"),u[t].sprite.draw(u[t].location.x,u[t].location.y));ctx.beginPath(),ctx.moveTo(l.center.x,l.center.y),ctx.lineTo(c,s),ctx.stroke()}(ctx)},1e3/r),_.emit(\"init_client\",l.location)}),_.on(\"all\",function(t){void 0===d?(x(t),d={state:t,timestamp:Date.now()}):g.push({state:t,timestamp:Date.now()})}),_.on(\"correction\",function(t){t.cc===v&&(l.location=t.corrected_location,v++)});const D=87,b=83,C=65,k=68;function E(t){t.preventDefault(),t.keyCode===C&&(l.commands.left=!0),t.keyCode===k&&(l.commands.right=!0),t.keyCode===D&&(l.commands.up=!0),t.keyCode===b&&(l.commands.down=!0)}function M(t){t.preventDefault(),t.keyCode===C&&(l.commands.left=!1),t.keyCode===k&&(l.commands.right=!1),t.keyCode===D&&(l.commands.up=!1),t.keyCode===b&&(l.commands.down=!1)}$(\"body\").mousemove(function(t){var e=canvas.getBoundingClientRect();c=t.clientX-e.left,s=t.clientY-e.top})}]);","extractedComments":[]}