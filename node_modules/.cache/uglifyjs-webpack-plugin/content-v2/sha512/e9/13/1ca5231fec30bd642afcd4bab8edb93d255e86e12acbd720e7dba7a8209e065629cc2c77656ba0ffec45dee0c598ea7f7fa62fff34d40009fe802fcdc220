{"code":"!function(t){var e={};function i(o){if(e[o])return e[o].exports;var s=e[o]={i:o,l:!1,exports:{}};return t[o].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var s in t)i.d(o,s,function(e){return t[e]}.bind(null,s));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,\"a\",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p=\"\",i(i.s=3)}([function(t,e){throw new Error(\"Module parse failed: Unexpected token (31:0)\\nYou may need an appropriate loader to handle this file type.\\n| ]\\n| \\n> class ImageContainer{\\n| \\n| \\tconstructor(){\")},function(t,e,i){\"use strict\";i(0);t.exports=class{constructor(t,e,i){let o=e.l,n=e.w;this.container={h:o,w:n},this.resize_factor=i,this.rows=s.rows,this.cols=s.cols,this.ctx=s.ctx,this.wait_time=1e3/s.fps,this.img=s.img,this.cur_frame=0,this.cur_row=0,this.srcX=0,this.srcY=0,this.last_update_time=Date.now(),this.off_set_x=0,this.off_set_y=0,this.img.complete&&(this.frame_width=this.img.width/this.cols,this.frame_height=this.img.height/this.rows,this.width=this.frame_width,this.height=this.frame_height,this.resize_factor&&this.resizeBy(this.resize_factor),this.center())}imageFinished(){this.frame_width||(this.frame_width=this.img.width/this.cols,this.frame_height=this.img.height/this.rows),this.width=this.frame_width,this.height=this.frame_height,this.resize_factor&&this.resizeBy(this.resize_factor),this.container&&this.center()}resizeTo(t,e){this.width=e,this.height=t}resizeBy(t){this.width=this.frame_width*t,this.height=this.frame_height*t,Math.round(this.height),Math.round(this.width),this.resize_factor=t}center(){this.off_set_x=this.container.w/2-this.width/2,this.off_set_y=this.container.h/2-this.height/2}setRow(t){t<0||t>=this.rows||(this.cur_row=t,this.srcY=this.cur_row*this.frame_height)}updateFrame(){Date.now()-this.last_update_time<this.wait_time||(this.last_update_time=Date.now(),++this.cur_frame>=this.cols&&(this.cur_frame=0),this.srcX=this.cur_frame*this.frame_width)}drawDirectional(t,e,i){i>=315||i<=45?this.setRow(2):i>45&&i<=135?this.setRow(0):i>135&&i<=225?this.setRow(1):this.setRow(3),this.draw(t,e)}draw(t,e){this.img.complete&&(this.updateFrame(),ctx.drawImage(this.img,this.srcX,this.srcY,this.frame_width,this.frame_height,t+this.off_set_x,e+this.off_set_y,this.width,this.height))}drawStatic(t,e,i,o){this.img.complete&&(this.srcX=o*this.frame_width,this.srcY=i*this.frame_height,ctx.drawImage(this.img,this.srcX,this.srcY,this.frame_width,this.frame_height,t+this.off_set_x,e+this.off_set_y,this.width,this.height))}}},function(t,e){throw new Error(\"Module parse failed: Unexpected token (13:9)\\nYou may need an appropriate loader to handle this file type.\\n| module.exports = {\\n| \\n>   exports.getLocationObj = function(x, y){\\n|     return {x, y};\\n|   }\")},function(t,e,i){\"use strict\";const o=i(2),s=i(1);var n=document.getElementById(\"canvas\"),r=n.getContext(\"2d\"),h=60,a=0,c=0,l=new o.Player;l.sprite=new s(\"Alien\",l.dimensions,2);var f,d=[],m=-1,u=0,w=0,_=[],p=100,g=0,y=!1,v=io.connect();function x(t,e){let i=f.state.locations[t],o=_[0].state.locations[t],s=_[0].timestamp-f.timestamp;0!==s&&(d[t].location.x+=(o.x-i.x)/s*(e-p-f.timestamp),d[t].location.y+=(o.y-i.y)/s*(e-p-f.timestamp))}function b(t){if(d.length!==t.locations.length)for(var e in d=[],t.locations){d.push({location:t.locations[e],dimensions:o.getDimensionsObj(100,50)});var i=new s(\"Person\",d[e].dimensions,.5);d[e].sprite=i}else for(var e in d)d[e].location=t.locations[e];m=t.self_index}function k(t,e){r.fillStyle=e,r.fillRect(t.location.x,t.location.y,t.dimensions.w,t.dimensions.l)}v.on(\"connect\",function(t){document.addEventListener(\"keydown\",j),document.addEventListener(\"keyup\",M),u=Date.now(),setInterval(function(){w=Date.now()-u,u=Date.now(),function(){var t=l.move(w);o.anyIntersect(l,d,m)&&(l.location=t);var e=o.checkBoundry(l.location,l.dimensions);l.location=e.loc,l.setOrientation(a,c)}(),function(){if(void 0===f||void 0===_)return;if(b(f.state),0===_.length)return;let t=Date.now();for(var e in d){if(e>=_[0].state.locations.length)break;if(e!=m)x(e,t);else{var i=_[_.length-1].state.self_index;d[e].location=_[_.length-1].state.locations[i]}}for(;_.length>0&&t-_[0].timestamp>=p;)f=_.shift()}(),v.emit(\"move\",{loc:l.location,cc:g}),function(){for(var t in r.clearRect(0,0,r.canvas.width,r.canvas.height),k(l,\"blue\"),l.sprite.drawDirectional(l.location.x,l.location.y,l.orientation),d)(t!=m||y&&t<d.length)&&(k(d[t],\"red\"),d[t].sprite.draw(d[t].location.x,d[t].location.y));r.beginPath(),r.moveTo(l.center.x,l.center.y),r.lineTo(a,c),r.stroke()}()},1e3/h),v.emit(\"init_client\",l.location)}),v.on(\"all\",function(t){void 0===f?(b(t),f={state:t,timestamp:Date.now()}):_.push({state:t,timestamp:Date.now()})}),v.on(\"correction\",function(t){t.cc===g&&(l.location=t.corrected_location,g++)});const D=87,C=83,z=65,O=68;function j(t){t.preventDefault(),t.keyCode===z&&(l.commands.left=!0),t.keyCode===O&&(l.commands.right=!0),t.keyCode===D&&(l.commands.up=!0),t.keyCode===C&&(l.commands.down=!0)}function M(t){t.preventDefault(),t.keyCode===z&&(l.commands.left=!1),t.keyCode===O&&(l.commands.right=!1),t.keyCode===D&&(l.commands.up=!1),t.keyCode===C&&(l.commands.down=!1)}$(\"body\").mousemove(function(t){var e=n.getBoundingClientRect();a=t.clientX-e.left,c=t.clientY-e.top})}]);","extractedComments":[]}