{"code":"!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=0)}([function(e,t,n){\"use strict\";var o,i=document.getElementById(\"canvas\"),a=60,c=0,r=0,l=new game_core.Player;l.sprite=new Sprite(\"Alien\",l.dimensions,2);var s,u=[],d=-1,f=0,m=0,p=[],y=100,v=0,g=!1,h=io.connect();function b(e,t){let n=s.state.locations[e],o=p[0].state.locations[e],i=p[0].timestamp-s.timestamp;0!==i&&(u[e].location.x+=(o.x-n.x)/i*(t-y-s.timestamp),u[e].location.y+=(o.y-n.y)/i*(t-y-s.timestamp))}function w(e){if(u.length!==e.locations.length)for(var t in u=[],e.locations){u.push({location:e.locations[t],dimensions:game_core.getDimensionsObj(100,50)});var n=new Sprite(\"Person\",u[t].dimensions,.5);u[t].sprite=n}else for(var t in u)u[t].location=e.locations[t];d=e.self_index}function x(e,t){o.fillStyle=t,o.fillRect(e.location.x,e.location.y,e.dimensions.w,e.dimensions.l)}h.on(\"connect\",function(e){document.addEventListener(\"keydown\",O),document.addEventListener(\"keyup\",j),o=i.getContext(\"2d\"),f=Date.now(),setInterval(function(){m=Date.now()-f,f=Date.now(),function(){var e=l.move(m);game_core.anyIntersect(l,u,d)&&(l.location=e);var t=game_core.checkBoundry(l.location,l.dimensions);l.location=t.loc,l.setOrientation(c,r)}(),function(){if(void 0===s||void 0===p)return;if(w(s.state),0===p.length)return;let e=Date.now();for(var t in u){if(t>=p[0].state.locations.length)break;if(t!=d)b(t,e);else{var n=p[p.length-1].state.self_index;u[t].location=p[p.length-1].state.locations[n]}}for(;p.length>0&&e-p[0].timestamp>=y;)s=p.shift()}(),h.emit(\"move\",{loc:l.location,cc:v}),function(){for(var e in o.clearRect(0,0,o.canvas.width,o.canvas.height),x(l,\"blue\"),l.sprite.drawDirectional(l.location.x,l.location.y,l.orientation),u)(e!=d||g&&e<u.length)&&(x(u[e],\"red\"),u[e].sprite.draw(u[e].location.x,u[e].location.y));o.beginPath(),o.moveTo(l.center.x,l.center.y),o.lineTo(c,r),o.stroke()}()},1e3/a),h.emit(\"init_client\",l.location)}),h.on(\"all\",function(e){void 0===s?(w(e),s={state:e,timestamp:Date.now()}):p.push({state:e,timestamp:Date.now()})}),h.on(\"correction\",function(e){e.cc===v&&(l.location=e.corrected_location,v++)});const _=87,k=83,C=65,D=68;function O(e){e.preventDefault(),e.keyCode===C&&(l.commands.left=!0),e.keyCode===D&&(l.commands.right=!0),e.keyCode===_&&(l.commands.up=!0),e.keyCode===k&&(l.commands.down=!0)}function j(e){e.preventDefault(),e.keyCode===C&&(l.commands.left=!1),e.keyCode===D&&(l.commands.right=!1),e.keyCode===_&&(l.commands.up=!1),e.keyCode===k&&(l.commands.down=!1)}$(\"body\").mousemove(function(e){var t=i.getBoundingClientRect();c=e.clientX-t.left,r=e.clientY-t.top})}]);","extractedComments":[]}